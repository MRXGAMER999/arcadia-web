<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join Beta Testing | Arcadia</title>
    <link rel="shortcut icon" href="../logo.svg" type="image/x-icon">
    <meta name="description" content="Join Arcadia's beta testing program and get early access to new features.">

    <!-- Critical CSS to prevent FOUC -->
    <style>
        body {
            background-color: #0F0F23;
            color: #ffffff;
            font-family: sans-serif;
            margin: 0;
            opacity: 1;
        }

        .glass-fallback {
            background: rgba(30, 42, 71, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Outfit:wght@300;400;500;600;800&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        navy: {
                            900: '#0F0F23',
                            800: '#151530',
                            700: '#1E1E3F',
                        },
                        violet: {
                            500: '#8b5cf6',
                            600: '#7c3aed',
                            glow: '#A78BFA',
                        },
                        cyan: {
                            500: '#06b6d4',
                            600: '#0891b2',
                        }
                    },
                    fontFamily: {
                        display: ['"Bebas Neue"', 'sans-serif'],
                        body: ['"Outfit"', 'sans-serif'],
                        mono: ['"JetBrains Mono"', 'monospace'],
                    },
                    backgroundImage: {
                        'hero-glow': 'radial-gradient(circle at 50% 50%, rgba(124, 58, 237, 0.15) 0%, rgba(15, 15, 35, 0) 70%)',
                        'noise': "url('https://grainy-gradients.vercel.app/noise.svg')",
                    }
                }
            }
        }
    </script>

    <style type="text/tailwindcss">
        @layer base {
            body::before {
                content: "";
                @apply fixed inset-0 bg-noise opacity-[0.03] pointer-events-none z-[60];
            }
        }
        @layer utilities {
            .glass-panel {
                @apply bg-navy-800/40 backdrop-blur-xl border border-white/10;
            }
            .glass-card {
                @apply bg-navy-800/60 backdrop-blur-md border border-white/5 hover:border-white/20 transition-all duration-300;
            }
            .text-glow {
                text-shadow: 0 0 30px rgba(139, 92, 246, 0.5);
            }
        }
    </style>
</head>

<body class="bg-navy-900 text-white antialiased overflow-x-hidden selection:bg-violet-600 selection:text-white">

    <!-- Background Effects -->
    <div class="absolute inset-0 pointer-events-none overflow-x-hidden">
        <div
            class="absolute top-1/4 left-1/4 w-96 h-96 bg-cyan-600/20 blur-[120px] rounded-full mix-blend-screen animate-pulse">
        </div>
        <div
            class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-violet-600/20 blur-[120px] rounded-full mix-blend-screen">
        </div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 px-4 bg-navy-900/90 backdrop-blur-md border-b border-white/10 py-3 shadow-2xl">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <!-- Logo -->
            <a href="../index.html" class="flex items-center">
                <span class="font-display text-3xl tracking-wide flex items-center pt-1 gap-0.5">
                    <span>A</span>
                    <svg class="h-7 w-7 mb-1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="30 30 320 320">
                        <defs>
                            <clipPath id="1bc524fdbf">
                                <path
                                    d="M 135 59.429688 L 329.863281 59.429688 L 329.863281 324.929688 L 135 324.929688 Z M 135 59.429688 "
                                    clip-rule="nonzero"></path>
                            </clipPath>
                            <clipPath id="b307a93635">
                                <path
                                    d="M 53.863281 59.429688 L 179 59.429688 L 179 126 L 53.863281 126 Z M 53.863281 59.429688 "
                                    clip-rule="nonzero"></path>
                            </clipPath>
                            <clipPath id="0f2c6a1c71">
                                <path d="M 136 92 L 297 92 L 297 324.929688 L 136 324.929688 Z M 136 92 "
                                    clip-rule="nonzero"></path>
                            </clipPath>
                            <clipPath id="f8e2f9d8ea">
                                <path
                                    d="M 53.863281 59.429688 L 179 59.429688 L 179 126 L 53.863281 126 Z M 53.863281 59.429688 "
                                    clip-rule="nonzero"></path>
                            </clipPath>
                        </defs>
                        <g clip-path="url(#1bc524fdbf)">
                            <path fill="#fbb02e"
                                d="M 258.703125 245.925781 L 311.164062 324.566406 L 230.675781 324.566406 L 180.15625 248.816406 L 135.984375 182.53125 C 135.984375 182.53125 235.371094 182.53125 235.410156 182.53125 C 250.863281 182.53125 263.820312 169.5625 263.820312 154.125 C 263.820312 138.453125 251.082031 125.714844 235.410156 125.714844 L 211.5 125.714844 L 167.328125 59.429688 L 235.410156 59.429688 C 287.726562 59.429688 330.101562 101.808594 330.101562 154.125 C 330.101562 180.257812 319.496094 203.933594 302.355469 221.070312 C 290.578125 232.847656 274.832031 241.8125 258.703125 245.925781 "
                                fill-opacity="1" fill-rule="evenodd"></path>
                        </g>
                        <g clip-path="url(#b307a93635)">
                            <path fill="#e8e5de"
                                d="M 178.582031 125.714844 L 98.089844 125.714844 L 53.898438 59.429688 L 134.398438 59.429688 Z M 178.582031 125.714844 "
                                fill-opacity="1" fill-rule="evenodd"></path>
                        </g>
                        <g clip-path="url(#0f2c6a1c71)">
                            <path fill="#fbb02e"
                                d="M 234.335938 217.777344 L 203.699219 217.777344 L 224.320312 248.78125 L 274.84375 324.566406 L 230.652344 324.566406 L 198.839844 276.769531 L 136.015625 182.5 C 136.015625 182.5 235.371094 182.5 235.441406 182.5 C 250.832031 182.5 263.796875 169.539062 263.796875 154.144531 C 263.796875 138.457031 251.054688 125.714844 235.441406 125.714844 L 211.515625 125.714844 L 189.425781 92.574219 L 234.335938 92.574219 C 268.953125 92.574219 296.9375 120.632812 296.9375 155.175781 C 296.9375 189.71875 268.953125 217.777344 234.335938 217.777344 "
                                fill-opacity="1" fill-rule="evenodd"></path>
                        </g>
                        <g clip-path="url(#f8e2f9d8ea)">
                            <path fill="#e8e5de"
                                d="M 53.898438 59.429688 L 98.089844 125.714844 L 178.582031 125.714844 L 156.488281 92.574219 L 122.957031 92.574219 C 97.167969 92.574219 72.660156 81.308594 55.875 61.734375 Z M 53.898438 59.429688 "
                                fill-opacity="1" fill-rule="evenodd"></path>
                        </g>
                    </svg>
                    <span>CADIA</span>
                </span>
            </a>

            <!-- Back to Home -->
            <a href="../index.html"
                class="bg-white text-navy-900 px-6 py-2.5 rounded-full font-body font-bold text-sm tracking-wide hover:bg-violet-200 transition-all shadow-[0_0_20px_rgba(255,255,255,0.2)] cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-violet-400/70 focus-visible:ring-offset-2 focus-visible:ring-offset-navy-900">
                <i class="fa-solid fa-arrow-left mr-2"></i>BACK TO HOME
            </a>
        </div>
    </nav>

    <!-- Hero Section -->
    <header
        class="relative min-h-[50vh] flex flex-col justify-center items-center text-center px-4 overflow-hidden pt-32 pb-16">

        <div class="relative z-10 max-w-4xl mx-auto">
            <h1 class="font-display text-6xl sm:text-7xl md:text-8xl leading-[0.9] tracking-tight mb-6">
                <span
                    class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-violet-400 to-white text-glow">JOIN</span><br>
                <span class="text-white">THE TESTING</span>
            </h1>
            <p class="font-body text-slate-400 text-lg md:text-xl max-w-2xl mx-auto font-light leading-relaxed">
                Get exclusive access to Arcadia's closed testing program on Google Play. Submit your email and we'll
                send you an invite.
            </p>
        </div>
    </header>

    <main class="max-w-xl mx-auto px-6 pb-32">
        <div class="glass-card rounded-3xl p-5 md:p-8">
            <!-- Sign-In Container -->
            <div id="signInContainer" class="space-y-6">
                <!-- Google Sign-In Button -->
                <button id="googleSignInBtn" type="button"
                    class="w-full px-8 py-4 bg-white text-navy-900 font-body font-bold text-base tracking-wide rounded-2xl hover:bg-gray-100 transition-all shadow-lg flex items-center justify-center gap-3">
                    <svg class="w-5 h-5" viewBox="0 0 24 24">
                        <path fill="#4285F4"
                            d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                        <path fill="#34A853"
                            d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                        <path fill="#FBBC05"
                            d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                        <path fill="#EA4335"
                            d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                    </svg>
                    CONTINUE WITH GOOGLE
                </button>

                <!-- Divider -->
                <div class="flex items-center gap-4">
                    <div class="flex-1 h-px bg-white/10"></div>
                    <span class="text-gray-500 text-sm font-body">or</span>
                    <div class="flex-1 h-px bg-white/10"></div>
                </div>

                <!-- Manual Form -->
                <form id="betaForm" class="space-y-6">
                    <div class="space-y-2">
                        <input id="userName" name="userName" type="text" autocomplete="name" placeholder="Full Name"
                            required
                            class="w-full px-0 py-4 bg-transparent border-b-2 border-white/20 text-white text-lg placeholder-gray-500 focus:outline-none focus:border-white" />
                    </div>

                    <div class="space-y-2">
                        <input id="userEmail" name="userEmail" type="email" autocomplete="email"
                            placeholder="Email Address" required
                            class="w-full px-0 py-4 bg-transparent border-b-2 border-white/20 text-white text-lg placeholder-gray-500 focus:outline-none focus:border-white" />
                        <p class="text-xs text-gray-500 px-0">Use the same email as your Google Play account</p>
                    </div>

                    <button type="submit"
                        class="w-full px-8 py-4 bg-gradient-to-r from-cyan-500 to-violet-500 text-white font-body font-bold text-base tracking-wide rounded-2xl hover:opacity-90 transition-all shadow-lg">
                        REQUEST ACCESS
                    </button>
                </form>

                <div id="status" class="text-sm font-semibold text-center min-h-[20px]" role="status"
                    aria-live="polite"></div>
            </div>

            <!-- Success state (hidden by default) -->
            <div id="successContainer" class="hidden space-y-6 text-center">
                <div
                    class="w-20 h-20 mx-auto rounded-full bg-gradient-to-br from-green-400 to-cyan-500 flex items-center justify-center">
                    <i class="fa-solid fa-check text-3xl text-white"></i>
                </div>
                <h2 class="font-body text-2xl font-semibold text-white">You're on the list!</h2>
                <p id="successEmail" class="text-cyan-400 font-mono text-sm"></p>
                <p class="text-sm text-gray-400">We'll send you an invite email soon.<br><span
                        class="text-xs text-gray-500">Check your inbox and spam folder</span></p>
            </div>

            <div class="mt-5 pt-8 border-t border-white/10 space-y-3 text-center">
                <p class="text-sm text-gray-400">After signing up, we'll add you to Google Play Console and send you an
                    invite email with the app link.</p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-white/5 bg-black py-12 px-4 text-center">
        <h2 class="font-display text-[15vw] leading-none text-white/5 select-none pointer-events-none mb-8">ARCADIA</h2>
        <div class="flex justify-center gap-8 text-sm text-gray-500 font-body flex-wrap">
            <a href="../index.html" class="hover:text-white transition-colors">Home</a>
            <a href="../privacy.html" class="hover:text-white transition-colors">Privacy</a>
            <a href="../terms.html" class="hover:text-white transition-colors">Terms</a>
            <a href="../feedback.html" class="hover:text-white transition-colors">Feedback</a>
            <a href="../delete-account/" class="hover:text-white transition-colors">Delete Account</a>
            <a href="#" class="hover:text-white transition-colors text-cyan-400">Join Beta</a>
            <a href="#" class="hover:text-white transition-colors flex items-center gap-2"><i
                    class="fa-brands fa-discord"></i> Discord</a>
        </div>
        <p class="mt-8 text-gray-700 text-xs">Â© 2026 Arcadia Inc. All rights reserved.</p>
    </footer>

    <script>
        // Configuration
        const GOOGLE_CLIENT_ID = '885431104790-ldh81hcamilundviuoiga5io68vc4f3o.apps.googleusercontent.com'; // Replace with your Google OAuth Client ID
        const APPWRITE_FUNCTION_URL = 'https://6978c55d00295a6420ae.fra.appwrite.run';

        // DOM Elements
        const signInBtn = document.getElementById('googleSignInBtn');
        const statusEl = document.getElementById('status');
        const signInContainer = document.getElementById('signInContainer');
        const successContainer = document.getElementById('successContainer');
        const successEmail = document.getElementById('successEmail');

        // Initialize Google Identity Services
        let googleClient;

        function initGoogleSignIn() {
            googleClient = google.accounts.oauth2.initTokenClient({
                client_id: GOOGLE_CLIENT_ID,
                scope: 'email profile',
                callback: handleGoogleResponse,
            });
        }

        // Wait for Google Identity Services to load
        window.onload = function () {
            if (typeof google !== 'undefined') {
                initGoogleSignIn();
            } else {
                // Retry after a short delay if not loaded yet
                setTimeout(() => {
                    if (typeof google !== 'undefined') {
                        initGoogleSignIn();
                    } else {
                        statusEl.textContent = 'Failed to load Google Sign-In. Please refresh the page.';
                        statusEl.classList.add('text-red-400');
                    }
                }, 1000);
            }
        };

        // Handle Google Sign-In button click
        signInBtn.addEventListener('click', () => {
            if (!googleClient) {
                statusEl.textContent = 'Google Sign-In is still loading. Please try again.';
                statusEl.classList.add('text-yellow-400');
                return;
            }

            statusEl.textContent = '';
            statusEl.className = 'text-sm font-semibold text-center min-h-[20px]';
            googleClient.requestAccessToken();
        });

        // Handle Google OAuth response
        async function handleGoogleResponse(response) {
            if (response.error) {
                statusEl.textContent = 'Google Sign-In was cancelled or failed.';
                statusEl.classList.add('text-red-400');
                return;
            }

            // Update button state
            const originalText = signInBtn.innerHTML;
            signInBtn.disabled = true;
            signInBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i>SIGNING UP...';

            try {
                // Get user info from Google
                const userInfoResponse = await fetch('https://www.googleapis.com/oauth2/v2/userinfo', {
                    headers: { Authorization: `Bearer ${response.access_token}` }
                });

                if (!userInfoResponse.ok) {
                    throw new Error('Failed to get user info from Google');
                }

                const userInfo = await userInfoResponse.json();
                const payload = {
                    userName: userInfo.name,
                    userEmail: userInfo.email
                };

                // Send to backend
                const result = await sendBetaRequest(payload);

                if (result.success) {
                    // Show success state
                    signInContainer.classList.add('hidden');
                    successContainer.classList.remove('hidden');
                    successEmail.textContent = userInfo.email;
                } else {
                    statusEl.textContent = result.error || 'Failed to submit. Please try again.';
                    statusEl.classList.add('text-red-400');
                }
            } catch (err) {
                console.error('Error:', err);
                statusEl.textContent = 'Network error. Please check your connection and try again.';
                statusEl.classList.add('text-red-400');
            } finally {
                signInBtn.disabled = false;
                signInBtn.innerHTML = originalText;
            }
        }

        async function sendBetaRequest(payload) {

            const res = await fetch(APPWRITE_FUNCTION_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify(payload)
            });

            // Always try to parse JSON response to get error messages
            const data = await res.json();
            return data;
        }

        // Handle manual form submission
        const form = document.getElementById('betaForm');
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            statusEl.textContent = '';
            statusEl.className = 'text-sm font-semibold text-center min-h-[20px]';

            const userName = (form.userName.value || '').trim();
            const userEmail = (form.userEmail.value || '').trim();
            const payload = { userName, userEmail };

            const btn = form.querySelector('button[type="submit"]');
            const originalText = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i>SUBMITTING...';

            try {
                const result = await sendBetaRequest(payload);

                if (result.success) {
                    // Show success state
                    signInContainer.classList.add('hidden');
                    successContainer.classList.remove('hidden');
                    successEmail.textContent = userEmail;
                } else {
                    statusEl.textContent = result.error || 'Failed to submit. Please try again.';
                    statusEl.classList.add('text-red-400');
                }
            } catch (err) {
                console.error('Error:', err);
                statusEl.textContent = 'Network error. Please check your connection and try again.';
                statusEl.classList.add('text-red-400');
            } finally {
                btn.disabled = false;
                btn.innerHTML = originalText;
            }
        });
    </script>
</body>

</html>